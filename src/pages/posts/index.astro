---
import { vstack } from "../../../styled-system/patterns";
import Layout from "../../layout/index.astro";
import PostListItem from "../../components/PostListItem.astro";
import PostYears from "../../components/PostYears.astro";
import { parseDate } from "../../utils";
import type { MarkdownFrontmatter } from "../../types";

const allPosts = await Astro.glob<MarkdownFrontmatter>("./**/*.md");
---

<Layout title="Markdown Posts">
  <ul class={vstack({ gap: 2, alignItems: "stretch" })}>
    {
      allPosts
        .sort(
          (a, b) =>
            new Date(b.frontmatter?.date ?? 0).getTime() -
            new Date(a.frontmatter?.date ?? 0).getTime(),
        )
        .map((post) => (
          <PostListItem
            href={post.url}
            title={post.frontmatter?.title}
            author={post.frontmatter?.author}
            date={parseDate(post.frontmatter?.date)}
            disablePrefix
          />
        ))
    }
  </ul>
  <PostYears slot="sidebar-top" />
  <PostYears slot="drawer-top" />
</Layout>
