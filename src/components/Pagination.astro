---
import type { Page } from "astro";
import PaperLink from "./PaperLink.astro";
import { getPagination } from "../utils";
import { cva } from "../../styled-system/css";
import { flex } from "../../styled-system/patterns";

const paginationButtonStyle = cva({
  base: {
    fontSize: ["sm", "md"],
  },
  variants: {
    display: {
      base: {},
      optional: {
        hideBelow: "sm",
      },
    },
  },
  defaultVariants: {
    display: "optional",
  },
});

interface Props {
  page: Page;
  basePath: string;
}
const { page, basePath } = Astro.props;
const { currentPage, lastPage } = page;

const paginations = getPagination(currentPage, lastPage, { neighbors: 2 });
---

{
  lastPage > 1 && (
    <nav
      class={flex({
        maxWidth: "100%",
        overflowX: "auto",
        justifyContent: "center",
      })}
    >
      <div
        class={flex({
          px: 1,
          direction: "row",
          alignItems: "center",
          justifyContent: "center",
          width: "max-content",
          gap: 1,
        })}
      >
        {paginations.map(({ value, optional }) => (
          <PaperLink
            className={paginationButtonStyle({
              display: optional ? "optional" : "base",
            })}
            href={value === 1 ? basePath : `${basePath}/${value}`}
            selected={value === currentPage}
          >
            {value}
          </PaperLink>
        ))}
      </div>
    </nav>
  )
}
